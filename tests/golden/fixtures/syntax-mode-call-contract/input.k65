// Test function mode contracts and call-site bridging
//
// - func with @a16 contract: caller emits REP #$20 before JSR
// - func with @a8 @i8 contract: caller emits SEP #$30 before JSR
// - func with @a16 @i16 contract: caller emits REP #$30 (folded)
// - func with no contract ("uncolored"): no REP/SEP at call site

func wide_a @a16 {
  lda #1
}

func narrow_all @a8 @i8 {
  lda #1
  ldx #1
}

func wide_all @a16 @i16 {
  lda #1
  ldx #1
}

func plain {
  nop
}

main {
  // Colored calls: emit mode bridge before JSR
  call wide_a
  call narrow_all
  call wide_all
  // Uncolored call: no REP/SEP emitted
  call plain
  @a16 call plain
  @a8  call plain
  nop
}
